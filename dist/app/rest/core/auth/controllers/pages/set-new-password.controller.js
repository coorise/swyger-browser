var h=(d,o,a)=>new Promise((l,s)=>{var c=t=>{try{r(a.next(t))}catch(m){s(m)}},n=t=>{try{r(a.throw(t))}catch(m){s(m)}},r=t=>t.done?l(t.value):Promise.resolve(t.value).then(c,n);r((a=a.apply(d,o)).next())});import{ErrorLoginValidation as k,LoginValidation as N}from"../../validations/login.validation.js";const q=d=>h(void 0,null,function*(){var r,t;const{req:o,controller:a}=d;o.$router;const l=a.client;let s={title:"Auth Set New Password | Agglomy !",meta:[{name:"child value",content:"child content value"}]};const c={index:"pages/verify-code.html"};let n={message:((r=o.query)==null?void 0:r.message)||"",page:"",user:{email:(t=o.query)==null?void 0:t.email,password:""},error:k,clientError:"",verifyCode(){return h(this,null,function*(){var f,g,v,w;try{if(N(this.user,this.error)==="ok"){ENV==="dev"&&console.log("All Fields are completed");let u={email:this.user.email,password:this.user.password},e=yield l==null?void 0:l.auth().verifyTokenCode(u).val();if(e!=null&&e.error){let i=(f=e==null?void 0:e.error)==null?void 0:f.auth;switch(i==null?void 0:i.code){case 600:this.clientError=(i==null?void 0:i.message)||"This User does not exit!";break;case 607:this.clientError=(i==null?void 0:i.message)||"Code is Not Still Verified!";break}}else(g=e==null?void 0:e.data)!=null&&g.data?(this.clientError="",o.go()):(v=e==null?void 0:e.data)!=null&&v.token||(this.clientError="We noticed you are already logged in from another device.For security reason, we have sent a verification code to: "+((w=this.user)==null?void 0:w.email))}}catch(y){ENV==="dev"&&console.log(y)}})},refreshToken(){}};yield a.render({data:n,meta:s,views:c})});export{q as default};
//# sourceMappingURL=set-new-password.controller.js.map
