{"version":3,"file":"register.controller.js","sources":["../../../../../../../src/app/rest/core/auth/controllers/pages/register.controller.js"],"sourcesContent":["import {ErrorRegisterValidation,RegisterValidation} from \"../../validations/register.validation.js\";\r\nconst RegisterController = async (args)=>{\r\n  const {req,controller}=args;\r\n  //req.io.auth.socket.privateClient=true\r\n  //controller.client.io=req.io\r\n  //console.log('path : ', req.path)\r\n  //console.log('query : ', req.query)\r\n  //console.log('param : ', req.param)\r\n  const router=req.$router\r\n  //router.go('/')\r\n  //router.back('path')\r\n  //router.mount('path',function)\r\n  //router.off('path')\r\n  //router.reload()\r\n  const client=controller.client\r\n  let meta={\r\n    title:\"Register | Agglomy !\",\r\n    meta: [\r\n      {\r\n        name: \"child value\",\r\n        content: \"child content value\"\r\n      },\r\n    ]\r\n    // name:\"Name\"\r\n  }\r\n\r\n  const views={\r\n    // that is a way to import your template\r\n    // the let is the name and right side is the path\r\n    //so on your parent template, use  eg: <index/>\r\n    index:'pages/register.html',\r\n  }\r\n\r\n\r\n  /*localStorage.setItem('accessToken','mmm')\r\n  localStorage.setItem('refreshToken',\r\n    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOnsiZXh0cmFzIjpudWxsLCJhY2ViYXNlVG9rZW4iOm51bGwsImVtYWlsIjoidXNlcjFAZ21haWwuY29tIiwic3RhdHVzIjoib2ZmbGluZSIsImlzRW1haWxGcm9tTG9jYWwiOmZhbHNlLCJpc0VtYWlsVmVyaWZpZWQiOmZhbHNlLCJpc1Bob25lVmVyaWZpZWQiOmZhbHNlLCJpc1Bhc3NDb2RlVmVyaWZpZWQiOmZhbHNlLCJlbWFpbENvZGUiOm51bGwsInBob25lQ29kZSI6bnVsbCwicGFzc3dvcmRDb2RlIjpudWxsLCJudW1iZXJQaG9uZSI6bnVsbCwiZW1haWxDb2RlRXhwaXJlcyI6bnVsbCwicGFzc3dvcmRDb2RlRXhwaXJlcyI6bnVsbCwicGhvbmVDb2RlRXhwaXJlcyI6bnVsbCwiaWQiOiI2M2NkYTBhNjcwMjVlNjMzYTQ2ODA3NzIiLCJ1aWQiOiJkNmJhZjljMy0zMTRhLTQxZWMtYTQzZi1kODk1ZGRkODY5NzYiLCJjcmVhdGVkQXQiOiIyMDIzLTAxLTIyIDEyOjMwIiwidXBkYXRlZEF0IjoiMjAyMy0wMS0yMiAxMjozMCJ9LCJpYXQiOjE2NzQ2ODM5MjAsImV4cCI6MTY3OTg2NzkyMH0.lS6q_cMD-sdNxlPOA7S6QVU5nAO2k0s5ozZrYTEqq9M'\r\n  )*/\r\n\r\n\r\n  let data={\r\n    user: controller.authModel,\r\n    confirm_password:'',\r\n    error:ErrorRegisterValidation,\r\n    clientError:'',\r\n    async registerUser(){\r\n      //e.preventDefault(); // Otherwise the form will be submitted\r\n      try{\r\n        let validation = RegisterValidation(this.user,this.confirm_password,this.error)\r\n        if( validation === 'ok'){\r\n          if(ENV==='dev') console.log('All Fields are completed');\r\n          let mUser={\r\n            //username:this.user.username,\r\n            email:this.user.email,\r\n            password:this.user.password\r\n          }\r\n          let response=await client?.auth?.auth().register(mUser).val()\r\n          if(response?.error){\r\n            let authError=response?.error?.auth\r\n            switch (authError?.code) {\r\n              case 602:\r\n                this.clientError=authError?.message || 'Sorry,this Email already exists!'\r\n                break;\r\n\r\n            }\r\n          }else if (response?.data?.data){\r\n            this.clientError=''\r\n            //let result=response?.data\r\n            //result?.data //for user info\r\n            //result?.refreshToken //for refresh token\r\n            //result?.token //for  token\r\n            req.go()\r\n          }\r\n        }\r\n      }catch (e) {\r\n        if(ENV==='dev')\r\n          console.log(e);\r\n      }\r\n    },\r\n\r\n  }\r\n  await controller.render({data, meta,views})\r\n}\r\n\r\nexport default  RegisterController\r\n"],"names":["RegisterController","args","__async","req","controller","client","meta","views","data","ErrorRegisterValidation","RegisterValidation","mUser","response","_a","authError","_b","_c","e"],"mappings":"wTACK,MAACA,EAA4BC,GAAOC,EAAA,wBACvC,KAAM,CAAC,IAAAC,EAAI,WAAAC,CAAU,EAAEH,EAMVE,EAAI,QAMjB,MAAME,EAAOD,EAAW,OACxB,IAAIE,EAAK,CACP,MAAM,uBACN,KAAM,CACJ,CACE,KAAM,cACN,QAAS,qBACV,CACF,CAEF,EAED,MAAMC,EAAM,CAIV,MAAM,qBACP,EASD,IAAIC,EAAK,CACP,KAAMJ,EAAW,UACjB,iBAAiB,GACjB,MAAMK,EACN,YAAY,GACN,cAAc,QAAAP,EAAA,gCAElB,GAAG,CAED,GADiBQ,EAAmB,KAAK,KAAK,KAAK,iBAAiB,KAAK,KAAK,IAC3D,KAAK,CACnB,MAAM,OAAO,QAAQ,IAAI,0BAA0B,EACtD,IAAIC,EAAM,CAER,MAAM,KAAK,KAAK,MAChB,SAAS,KAAK,KAAK,QACpB,EACGC,EAAS,MAAMC,EAAAR,GAAA,YAAAA,EAAQ,OAAR,YAAAQ,EAAc,OAAO,SAASF,GAAO,MACxD,GAAGC,GAAA,MAAAA,EAAU,MAAM,CACjB,IAAIE,GAAUC,EAAAH,GAAA,YAAAA,EAAU,QAAV,YAAAG,EAAiB,KAC/B,OAAQD,GAAA,YAAAA,EAAW,KAAI,CACrB,IAAK,KACH,KAAK,aAAYA,GAAA,YAAAA,EAAW,UAAW,mCACvC,KAEH,CACb,MAAoBE,EAAAJ,GAAA,YAAAA,EAAU,OAAV,MAAAI,EAAgB,OACxB,KAAK,YAAY,GAKjBb,EAAI,GAAI,EAEX,CACF,OAAOc,EAAP,CACI,MAAM,OACP,QAAQ,IAAIA,CAAC,CAChB,CACF,GAEF,EACD,MAAMb,EAAW,OAAO,CAAC,KAAAI,EAAM,KAAAF,EAAK,MAAAC,CAAK,CAAC,CAC5C"}