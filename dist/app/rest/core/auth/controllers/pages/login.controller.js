var g=(n,r,i)=>new Promise((l,s)=>{var c=t=>{try{h(i.next(t))}catch(o){s(o)}},d=t=>{try{h(i.throw(t))}catch(o){s(o)}},h=t=>t.done?l(t.value):Promise.resolve(t.value).then(c,d);h((i=i.apply(n,r)).next())});import{ErrorLoginValidation as w,LoginValidation as k}from"../../validations/login.validation.js";const L=n=>g(void 0,null,function*(){const{req:r,controller:i}=n;r.$router;const l=i.client;let s={title:"Login | Agglomy !",meta:[{name:"child value",content:"child content value"}]};const c={index:"pages/login.html"};let d={user:i==null?void 0:i.authModel,error:w,clientError:"",loginUser(){return g(this,null,function*(){var t,o,m,f,u;try{if(k(this.user,this.error)==="ok"){ENV==="dev"&&console.log("All Fields are completed");let y={email:this.user.email,password:this.user.password},e=yield(t=l==null?void 0:l.auth)==null?void 0:t.auth().login(y).val();if(e!=null&&e.error){let a=(o=e==null?void 0:e.error)==null?void 0:o.auth;switch(a==null?void 0:a.code){case 600:this.clientError=(a==null?void 0:a.message)||"This User does not exit!";break;case 601:this.clientError=(a==null?void 0:a.message)||"Verify your Password!";break}}else(m=e==null?void 0:e.data)!=null&&m.data?(this.clientError="",r.go()):(f=e==null?void 0:e.data)!=null&&f.token||(this.clientError="We noticed you are already logged in from another device.For security reason, we have sent a verification code to: "+((u=this.user)==null?void 0:u.email),r.go("/auth/verify-token-code?email="+this.user.email+"&message="+this.clientError))}}catch(v){ENV==="dev"&&console.log(v)}})},refreshToken(){}};yield i.render({data:d,meta:s,views:c})});export{L as default};
//# sourceMappingURL=login.controller.js.map
